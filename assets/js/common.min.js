(function($){
	'use strict'; 
	var prodesignWindow = window, prodesignAjax = _pdesignobject.ajaxurl; 

	let pbtn =$('.pdesign-save-wrap');
	let pds=$('form[class="cart"]');
	let pdv=$('form[class="variations_form cart"]');
	let pdg=$('form[class="cart grouped_form"]');
	let loaderButton = $( '.pdesign-save-btn');
	let colorCategory = $( '.prodesign-color-variation-select' );

	prodesignWindow.dposts = function dposts(d,a,ac='action'){
		d[ac] = a;
		return $.post( prodesignAjax, d );
	};
	
	prodesignWindow.pduploads = function pduploads(d,e){
		 return $.ajax({
		 			 type: 'POST',
           url: prodesignAjax,
           data: d,
           processData:false,
           contentType:false,
           beforeSend:function(){
             $(e).addClass('is_loading');
           },
           complete:function(){
          	$(e).removeClass('is_loading');
          }
      });
	};
	
	prodesignWindow.dnuploads= function dnuploads(d){
		return $.ajax({
		 			 type: 'POST',
           url: prodesignAjax,
           data: d,
           processData:false,
           contentType:false,
      });
	
	};

	prodesignWindow.cartPuthold = function cartPuthold(){
		     if(pds.length > 0){
		     		pds.addClass('prodesign-loading');
					  pbtn.addClass('prodesign-loading-block');
		     }else if(pdv.length > 0){
		     	   pdv.addClass('prodesign-loading');
		     	   pbtn.addClass('prodesign-loading-block');
		     }else if(pdg.length > 0){
		     	   pdg.addClass('prodesign-loading');
		     	   pbtn.addClass('prodesign-loading-block');
		     }
	};

	prodesignWindow.cartGethold = function cartGethold(){
				 if(pds.length > 0){
				 		pds.removeClass('prodesign-loading');
						loaderButton.removeClass('is_loading');
						pbtn.removeClass('prodesign-loading-block');
						return pds;
				  }else if(pdv.length > 0){
				  	pdv.removeClass('prodesign-loading');
				  	loaderButton.removeClass('is_loading');
				  	pbtn.removeClass('prodesign-loading-block');
				  	return pdv;
				  }else if(pdg.length > 0){
				  	pdg.removeClass('prodesign-loading');
				  	loaderButton.removeClass('is_loading');
				  	pbtn.removeClass('prodesign-loading-block');
				  	return pdg;
				  }
	};
	prodesignWindow.pdnPrintPDF = function pdnPrintPDF(){
		if(pds.length > 0){
			return pds;
	  }else if(pdv.length > 0){
	  	return pdv;
	  }else if(pdg.length > 0){
	  	return pdg;
	  }
	};
	prodesignWindow.pdnCheckVariation = function pdnCheckVariation(){
			if( colorCategory.length > 0 ){
				if( '' !== colorCategory.val() ){
					const selectDesigns = $( '.pdn-sdn-active' );
					if( 0 === selectDesigns.length ){
						$( '.pdn-select-required' ).remove();
						$( '.pdn-sdn-wrap-flex' ).after( '<p class="pdn-select-required">The design field is required</p>' );
				   	let scrollPos =  $( '.prodesign-color-wrap' ).offset().top;
           	$(window).scrollTop(scrollPos);

           $( 'input[name="pdesign-input"]').val('');
				   $( 'input[name="pdesign-color"]').val('#000000');
				   $( 'input[name="pdesign-select-font"]').val('Arial');
				   $( 'input[name="pdesign-select-size"]').val('16');
				   $( 'input[name="pdesign-sticker-size"]').val('50');

           	return false;
					}else{
						return true;
					} 
					 
				}else{
					 $( '.pdn-cerror' ).remove();
					 $( '.pdn-select-required' ).remove();
					 $( '.prodesign-color-flex' ).after( '<p class="pdn-cerror">The color variation is required.</p>' );
					 $( '.pdn-sdn-wrap-flex' ).after( '<p class="pdn-select-required">The design field is required</p>' );
				   let scrollPos =  $( '.prodesign-color-wrap' ).offset().top;
           $(window).scrollTop(scrollPos);

				   $( 'input[name="pdesign-input"]').val('');
				   $( 'input[name="pdesign-color"]').val('#000000');
				   $( 'input[name="pdesign-select-font"]').val('Arial');
				   $( 'input[name="pdesign-select-size"]').val('16');
				   $( 'input[name="pdesign-sticker-size"]').val('50');
					 return false;
				}
			}else{
				return true;
			}
	};
	prodesignWindow.colorVariationSvg = function colorVariationSvg(){
		return '<svg fill="#fff" version="1.1" id="prod-color-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 335.765 335.765" xml:space="preserve"><g><g><polygon points="311.757,41.803 107.573,245.96 23.986,162.364 0,186.393 107.573,293.962 335.765,65.795"/></g></g></svg>';
	};


	$( '#pdesign-text-can' ).draggable({
	 	containment:'#pdesign-gallery-image',
	 	cursor: 'move',
	});

	 $( '#pdesign-image-can' ).draggable({
	 	containment:'#pdesign-gallery-image',
	 	cursor: 'move',
	});

	$( '#pdesign-more-on' ).draggable({
	 	containment:'#pdesign-gallery-image',
	 	cursor: 'move',
	});

	$( '#pdesign-more-on' ).resizable();
	$( '#pdesign-text-can' ).resizable();
	$( '#pdesign-image-can' ).resizable();
   


})(jQuery);